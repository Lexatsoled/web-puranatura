INSTRUCCIONES PARA GROK AI - FASE 2 PUREZA NATURALIS V3

TU MISIÃ“N:
Ejecutar automÃ¡ticamente "FASE 2: Rendimiento & UX" - un conjunto de 5 tareas de optimizaciÃ³n para mejorar performance 30-50% en 1-2 semanas.

CONTEXTO:
- Proyecto: Pureza Naturalis V3 (e-commerce React + Fastify)
- Fase 1 (Seguridad): âœ… COMPLETADA
- Fase 2 (Performance): ğŸš€ COMIENZA HOY
- Tu rol: Ejecutar de forma automatizada y coordinada

========================
LAS 5 TAREAS DE FASE 2
========================

1. PERF-IMG-001: Optimizar ImÃ¡genes (picture element)
   Target: LCP 3.5s â†’ 2.4s (â†“30%)
   - Implementar <picture> con AVIF/WebP/JPEG
   - Convertir 1,131 JPGs a AVIF (80% reducciÃ³n)
   - Agregar srcset con 2x, 3x resoluciones
   - Archivos: src/components/ProductImage.tsx, scripts/optimize-images.js

2. PERF-BUNDLE-001: Reducir Bundle Size
   Target: 450KB â†’ 350KB (â†“30%)
   - Tree-shaking en Vite
   - Code splitting por rutas (lazy load)
   - Remover deps no usadas (lodash, moment.js)
   - Archivos: vite.config.ts, src/main.tsx

3. PERF-CACHE-001: Estrategias CachÃ© HTTP + Redis
   Target: TTFB 400ms â†’ 200-300ms, Hit Rate >60%
   - HTTP headers (Cache-Control, ETag, Last-Modified)
   - Redis backend caching
   - Client-side localStorage caching
   - Archivos: backend/src/plugins/cacheHeaders.ts, backend/src/plugins/redisCache.ts

4. PERF-N+1-001: Eliminar N+1 Queries
   Target: API P95 450ms â†’ 280ms (â†“38%), 11+ queries â†’ 2-3 (â†“82%)
   - Drizzle ORM JOINs en lugar de lazy loading
   - Query profiling (X-Query-Count header)
   - Indexes en claves forÃ¡neas
   - Archivos: backend/src/routes/v1/products.ts

5. UX-ERROR-001: Mejorar Manejo de Errores
   Target: Error Recovery >90%, Support Tickets â†“30%
   - Custom error hook con auto-retry
   - Exponential backoff (100ms, 200ms, 400ms)
   - Error Boundary component con mensajes contextuales
   - Archivos: src/hooks/useErrorBoundary.ts, src/components/ErrorBoundary.tsx

========================
RECURSOS A TU DISPOSICIÃ“N
========================

Tu kit contiene:
- ./tools/README_KIT_FASE_2.md (Ãndice maestro - LEER PRIMERO)
- ./tools/FASE_2_IMPLEMENTATION_GUIDE.md (GuÃ­a paso-a-paso)
- ./tools/FASE_2_SETUP.ps1 (Setup inicial)
- ./tools/FASE_2_VALIDATE.ps1 (Validador automÃ¡tico)
- ./tools/FASE_2_MONITOR.ps1 (Dashboard en vivo)
- ./tools/FASE_2_ROLLBACK.ps1 (Reversa automÃ¡tica)
- ./tools/tests/*.test.ts (5 test suites automÃ¡ticos)

TambiÃ©n disponibles:
- ./CHECKLIST_FASE_2.md (Checklist operativo)
- ./FASE_2_PLAN.md (Plan estratÃ©gico)
- ./REFERENCIA_RAPIDA.md (Quick reference)

========================
FLUJO RECOMENDADO
========================

DÃA 1: PREPARACIÃ“N (1-2 horas)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. Leer documentaciÃ³n en este orden:
   a) ./tools/README_KIT_FASE_2.md (30 min)
   b) ./tools/FASE_2_IMPLEMENTATION_GUIDE.md (30 min)
   c) ./CHECKLIST_FASE_2.md (15 min)

2. Ejecutar setup:
   .\tools\FASE_2_SETUP.ps1
   (Esperar a completar: 10-15 min)
   Verificar: ./tools/metrics/baseline.json existe

3. Verificar ambiente:
   git checkout fase-2
   npm run build
   npm run test

DÃAS 2-5: IMPLEMENTACIÃ“N (4 dÃ­as)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Para cada tarea (en orden o paralelo):

1. Leer instrucciones especÃ­ficas
   â†’ ./tools/FASE_2_IMPLEMENTATION_GUIDE.md (SecciÃ³n PERF-IMG-001, etc)

2. Implementar segÃºn instrucciones
   â†’ Copiar cÃ³digo de ejemplo de guÃ­a
   â†’ Hacer cambios en archivos especificados

3. Ejecutar tests
   â†’ npm run test -- tools/tests/perf-img.test.ts
   (Repetir hasta que PASEN todos)

4. Validar tarea
   â†’ .\tools\FASE_2_VALIDATE.ps1 -Task perf-img-001
   (Score debe ser 100%)

5. Monitorear mÃ©tricas
   â†’ .\tools\FASE_2_MONITOR.ps1
   (Verificar que mejoran vs baseline)

6. Commit cambios
   â†’ git add -A
   â†’ git commit -m "feat: PERF-IMG-001 image optimization with picture element"

DÃAS 6-7: VALIDACIÃ“N Y MERGE (1-2 dÃ­as)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. Validar todas las tareas:
   .\tools\FASE_2_VALIDATE.ps1 -CheckAll
   (Resultado: 5/5 tareas PASSED con 100%)

2. Ver dashboard final:
   .\tools\FASE_2_MONITOR.ps1 -ShowDetails
   (Verificar: LCP 2.3s, Bundle 320KB, API P95 280ms, Cache Hit 65%)

3. Crear Pull Request
   git push origin fase-2
   (En GitHub/GitLab: crear PR con resumen de mÃ©tricas)

4. Merge a main
   git checkout main
   git merge fase-2 --no-ff
   git push origin main

========================
COMANDOS CLAVE
========================

SETUP Y CONFIGURACIÃ“N:
.\tools\FASE_2_SETUP.ps1

VALIDACIÃ“N:
.\tools\FASE_2_VALIDATE.ps1 -Task perf-img-001     (una tarea)
.\tools\FASE_2_VALIDATE.ps1 -CheckAll               (todas)

MONITOREO:
.\tools\FASE_2_MONITOR.ps1                           (cada 30s)
.\tools\FASE_2_MONITOR.ps1 -Interval 10 -ShowDetails (cada 10s con detalles)

ROLLBACK (SI ALGO FALLA):
.\tools\FASE_2_ROLLBACK.ps1 -RevertLastCommit -Commits 3    (revertir 3 commits)
.\tools\FASE_2_ROLLBACK.ps1 -Task perf-bundle-001          (revertir tarea)
.\tools\FASE_2_ROLLBACK.ps1 -CleanBuild                     (limpiar y reconstruir)

TESTS:
npm run test -- tools/tests/perf-img.test.ts       (test especÃ­fico)
npm run test:fase2                                  (suite completa)

GIT:
git checkout fase-2                                 (cambiar a rama)
git add -A && git commit -m "descripciÃ³n"          (commit cambios)
git push origin fase-2                              (push rama)
git checkout main && git merge fase-2 --no-ff      (merge a main)

========================
CÃ“MO PROCEDER ANTE PROBLEMAS
========================

SI UN TEST FALLA:
1. Ejecutar con verbose:
   npm run test -- tools/tests/TASK.test.ts --reporter=verbose

2. Revisar la guÃ­a:
   ./tools/FASE_2_IMPLEMENTATION_GUIDE.md (secciÃ³n correspondiente)

3. Si persiste:
   .\tools\FASE_2_ROLLBACK.ps1 -Task TASK_ID
   (empezar tarea de nuevo)

SI MÃ‰TRICAS NO MEJORAN:
1. Verificar cambios estÃ¡n en lugar:
   git diff

2. Monitorear:
   .\tools\FASE_2_MONITOR.ps1 -ShowDetails

3. Comparar con baseline:
   cat ./tools/metrics/baseline.json

SI NECESITAS REVERTIR:
.\tools\FASE_2_ROLLBACK.ps1 -RevertLastCommit -Commits 5  (revertir commits)
.\tools\FASE_2_ROLLBACK.ps1 -FullRollback                  (Ãºltimo recurso)

========================
DEFINICIÃ“N DE "HECHO"
========================

Fase 2 estÃ¡ COMPLETADA cuando:

âœ… .\tools\FASE_2_VALIDATE.ps1 -CheckAll muestra 5/5 PASSED
âœ… npm run test:fase2 todos pasan
âœ… MÃ©tricas mejoran â‰¥30% (vs baseline):
   - LCP: 3.5s â†’ 2.4s âœ…
   - Bundle: 450KB â†’ 320KB âœ…
   - API P95: 450ms â†’ 280ms âœ…
   - Cache Hit: 20% â†’ 60%+ âœ…
   - Queries: 11+ â†’ 2-3 âœ…
âœ… Pull Request aprobado
âœ… Mergeado a main sin conflictos
âœ… Deployment exitoso

========================
INICIO INMEDIATO
========================

Ejecuta AHORA en terminal:

cd c:\Users\Usuario\Desktop\Web Puranatura\Pureza-Naturalis-V3

1. .\tools\FASE_2_SETUP.ps1

2. cat ./tools/README_KIT_FASE_2.md

3. Seguir el flujo de "DÃAS 2-5: IMPLEMENTACIÃ“N"

========================
IMPORTANTE
========================

âœ… DEBES:
- Leer toda la documentaciÃ³n antes de empezar
- Ejecutar tests automÃ¡ticos para cada tarea
- Validar con FASE_2_VALIDATE.ps1 antes de pasar a siguiente
- Hacer commits descriptivos despuÃ©s de cada tarea
- Monitorear mÃ©tricas en tiempo real

âŒ NO DEBES:
- Cambios sin validaciÃ³n previa
- Omitir tests automÃ¡ticos
- Comprometer seguridad por performance (Fase 1 debe mantenerse)
- Modificar DB sin backup
- Commits sin mensaje descriptivo

========================
RECURSOS DE REFERENCIA
========================

DocumentaciÃ³n completa en: ./tools/

Si necesitas:
- Setup help â†’ ./tools/README_KIT_FASE_2.md
- CÃ³mo implementar â†’ ./tools/FASE_2_IMPLEMENTATION_GUIDE.md
- ValidaciÃ³n verbose â†’ .\tools\FASE_2_VALIDATE.ps1 -Verbose
- Rollback help â†’ .\tools\FASE_2_ROLLBACK.ps1
- Quick reference â†’ ./REFERENCIA_RAPIDA.md
- Checklist â†’ ./CHECKLIST_FASE_2.md

========================
Â¡ESTÃS LISTO PARA COMENZAR!
========================

PrÃ³ximo paso: Abre PowerShell y ejecuta:

cd c:\Users\Usuario\Desktop\Web Puranatura\Pureza-Naturalis-V3
.\tools\FASE_2_SETUP.ps1

DespuÃ©s: Lee ./tools/README_KIT_FASE_2.md

Â¡Buena suerte con Fase 2!
