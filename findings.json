{
  "meta": {
    "version": 1,
    "severity_scale": ["info", "low", "medium", "high", "critical"],
    "generated_at": "2025-12-13T20:30:00Z"
  },
  "findings": [
    {
      "id": "SEC-AUTH-001",
      "title": "Almacenamiento de JWT en localStorage",
      "category": "security",
      "subcategory": "auth",
      "severity": "medium",
      "likelihood": 3,
      "priority": 9,
      "where": {
        "file": "src/store/authStore.ts",
        "line": 20,
        "snippet": "persist(..., { name: 'auth-storage' })"
      },
      "evidence": "El store de Zustand persiste el token JWT en localStorage. Esto expone el token a ataques XSS.",
      "impact": "Si un atacante logra XSS, puede exfiltrar el token y secuestrar la sesión.",
      "recommendation": "Migrar a cookies HttpOnly y SameSite=Strict para el almacenamiento del token. El backend ya soporta lectura de cookies.",
      "fix_example": "Mover lógica de persistencia de token a cookies httpOnly gestionadas por el servidor.",
      "references": ["OWASP LocalStorage vs Cookies"],
      "tests": ["test/backend.cookies.test.ts"]
    },
    {
      "id": "SEC-XSS-001",
      "title": "Uso de dangerouslySetInnerHTML en Modales",
      "category": "security",
      "subcategory": "xss",
      "severity": "low",
      "likelihood": 1,
      "priority": 2,
      "where": {
        "file": "src/components/blog/BlogPostModal.tsx",
        "line": 93,
        "snippet": "dangerouslySetInnerHTML={{ __html: sanitizeHTML(post.content) }}"
      },
      "evidence": "Uso explícito de inyección HTML.",
      "impact": "Riesgo de XSS si la función sanitizeHTML falla o el sanitizer se configura mal en el futuro.",
      "recommendation": "Mantener vigilancia sobre 'src/utils/sanitizer.ts'. Configurar tests de snapshot para sanitizer.",
      "fix_example": "N/A (Actualmente mitigado por DOMPurify correctamente implementado).",
      "references": ["React Security Guide"],
      "tests": ["src/utils/__tests__/sanitizer.test.ts"]
    },
    {
      "id": "PERF-IMG-001",
      "title": "Optimización de Imágenes y Carga",
      "category": "performance",
      "subcategory": "assets",
      "severity": "info",
      "likelihood": 1,
      "priority": 1,
      "where": {
        "file": "src/components/OptimizedImage.tsx",
        "line": 1,
        "snippet": "Entire File"
      },
      "evidence": "El proyecto ya utiliza 'vite-imagetools' y componentes optimizados. Excelente práctica.",
      "impact": "Positivo: Tiempos de carga reducidos.",
      "recommendation": "Continuar con esta práctica. Verificar que todas las nuevas imágenes usen este componente.",
      "metrics": { "lcp_impact": "positive" }
    },
    {
      "id": "A11Y-INT-001",
      "title": "Elementos interactivos no nativos (div buttons)",
      "category": "accessibility",
      "subcategory": "semantic",
      "severity": "low",
      "likelihood": 2,
      "priority": 4,
      "where": {
        "file": "src/components/auth/AuthModal.tsx",
        "line": 37,
        "snippet": "onClick={onClose} role=\"button\""
      },
      "evidence": "Uso de div con onClick. Aunque tiene role y tabIndex, es fácil olvidar handlers de teclado.",
      "impact": "Usuarios de teclado podrían tener dificultades si falta onKeyDown.",
      "recommendation": "Reemplazar divs interactivos por etiquetas <button> reales donde sea posible para obtener comportamiento nativo.",
      "fix_example": "<button className=\"...\" onClick={onClose} ... />"
    },
    {
      "id": "ARCH-BE-001",
      "title": "Resiliencia: Circuit Breaker y Caching implementados",
      "category": "architecture",
      "subcategory": "reliability",
      "severity": "info",
      "likelihood": 1,
      "priority": 1,
      "where": {
        "file": "backend/src/routes/products.ts",
        "line": 15,
        "snippet": "new CatalogBreaker(...)"
      },
      "evidence": "El backend implementa patrones avanzados de resiliencia.",
      "impact": "Alta disponibilidad incluso bajo carga o fallos de DB.",
      "recommendation": "Expandir uso de Circuit Breaker a otras rutas críticas."
    }
  ]
}
