{
  "meta": {
    "version": 1,
    "severity_scale": ["info", "low", "medium", "high", "critical"]
  },
  "findings": [
    {
      "id": "SEC-LOG-001",
      "title": "Exposición de información en logs de arranque",
      "category": "security",
      "subcategory": "information-disclosure",
      "severity": "low",
      "likelihood": 3,
      "priority": 6,
      "where": {
        "file": "backend/src/server.ts",
        "line": 12,
        "snippet": "console.log('[env] rate limits', { ... })"
      },
      "evidence": "El servidor imprime configuración de rate limits al iniciar.",
      "impact": "Un atacante con acceso a logs podría conocer los umbrales de rate limit para ajustar sus ataques.",
      "recommendation": "Usar un logger estructurado (ej. Winston/Pino) y nivel de log adecuado. Evitar loguear configuración interna en producción.",
      "fix_example": "logger.debug('Rate limits configured', { ... })"
    },
    {
      "id": "SEC-ESLINT-001",
      "title": "Regla de seguridad desactivada en ESLint",
      "category": "security",
      "subcategory": "configuration",
      "severity": "medium",
      "likelihood": 2,
      "priority": 8,
      "where": {
        "file": "eslint.config.cjs",
        "line": 38,
        "snippet": "'security/detect-object-injection': 'off'"
      },
      "evidence": "La regla 'security/detect-object-injection' está explícitamente desactivada.",
      "impact": "Riesgo de no detectar vulnerabilidades de inyección de objetos que podrían llevar a DoS o ejecución de código.",
      "recommendation": "Reactivar la regla y corregir los falsos positivos o usar validación de esquema (Zod) para inputs.",
      "fix_example": "// 'security/detect-object-injection': 'warn'"
    },
    {
      "id": "PERF-UX-001",
      "title": "Fallback de carga genérico",
      "category": "performance",
      "subcategory": "ux",
      "severity": "low",
      "likelihood": 5,
      "priority": 5,
      "where": {
        "file": "src/App.tsx",
        "line": 36,
        "snippet": "<div>Cargando...</div>"
      },
      "evidence": "Se usa un div simple con texto 'Cargando...' durante la carga perezosa de rutas.",
      "impact": "Experiencia de usuario pobre (CLS, falta de feedback visual de marca).",
      "recommendation": "Implementar un componente 'Skeleton' o 'Spinner' que coincida con el layout.",
      "fix_example": "<Suspense fallback={<LoadingSpinner />}>"
    },
    {
      "id": "CODE-TS-001",
      "title": "Uso de 'any' en manejo de errores",
      "category": "maintainability",
      "subcategory": "typescript",
      "severity": "low",
      "likelihood": 5,
      "priority": 3,
      "where": {
        "file": "backend/src/server.ts",
        "line": 25,
        "snippet": "server.on('error', (err: any) => { ... })"
      },
      "evidence": "Uso explícito de 'any' para el error del servidor.",
      "impact": "Pérdida de seguridad de tipos y autocompletado.",
      "recommendation": "Usar el tipo 'NodeJS.ErrnoException' o similar.",
      "fix_example": "(err: NodeJS.ErrnoException)"
    }
  ]
}
